# Тест-кейсы для проверки API микросервиса объявлений

В этом документе описаны сценарии тестирования для проверки работы REST API сервиса, обеспечивающего создание, получение, статистику и удаление объявлений.

---
**Исходные условия:**

- Сервис доступен по адресу: `https://qa-internship.avito.com/api/1/item`.
- Используется валидное значение sellerID (в диапазоне от 111111 до 999999).

**Пошаговый сценарий:**

1. Отправить POST-запрос с телом:
    ```json
    {
      "sellerID": 123456,
      "name": "Тестовое объявление",
      "price": 100,
      "statistics": {
        "contacts": 5,
        "likes": 3,
        "viewCount": 10
      }
    }
    ```
2. Проверить, что HTTP-статус ответа равен 200.
3. Убедиться, что в ответе присутствует либо поле `id`, либо поле `status` с сообщением (например, «Сохранили объявление - <UUID>»).

**Ожидаемый результат:**

- Код ответа: 200.
- Тело ответа содержит либо идентификатор объявления, либо сообщение о сохранении.

---
### 1.2. Создание объявления с некорректным значением sellerID

**Пошаговый сценарий:**

1. Отправить POST-запрос с данными:
    ```json
    {
      "sellerID": "abc123",
      "name": "Объявление с ошибкой",
      "price": 1000,
      "statistics": {
        "contacts": 5,
        "likes": 3,
        "viewCount": 10
      }
    }
    ```
2. Проверить, что сервер возвращает HTTP-код 400.
3. Убедиться, что ответ содержит поля `result` и `status` с описанием ошибки.

**Ожидаемый результат:**

- Код ответа: 400.
- Ответ содержит поля `result` и `status`.

---
### 1.3. Создание объявления с отсутствием обязательных параметров

**Пошаговый сценарий:**

1. Отправить POST-запрос, пропустив обязательные поля (например, `name` и `price`):
    ```json
    {
      "sellerID": 123456
    }
    ```
2. Убедиться, что сервер отвечает кодом 400.
3. Проверить наличие полей `result` и `status` в теле ответа.

**Ожидаемый результат:**

- Код ответа: 400.
- Тело ответа включает поля `result` и `status` с указанием недостающих параметров.

---
## 2. Получение объявления по ID (GET /api/1/item/:id)

### 2.1. Успешное получение объявления

**Исходные условия:**

- Объявление с указанным идентификатором уже создано (получено через POST-запрос).

**Пошаговый сценарий:**

1. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/1/item/<id>`.
2. Убедиться, что HTTP-статус равен 200.
3. Проверить, что возвращаемый ответ – массив, в котором первый элемент содержит поля:
    - `id`
    - `sellerId`
    - `name`
    - `price`
    - `statistics` (объект с полями: `likes`, `viewCount`, `contacts`)
    - `createdAt`
4. Сравнить значение поля `id` с ожидаемым.

**Ожидаемый результат:**

- Код ответа: 200.
- Ответ – массив объектов, где первый элемент имеет указанные поля и корректный `id`.

---

### 2.2. Запрос несуществующего объявления

**Пошаговый сценарий:**

1. Использовать несуществующий идентификатор (например, `00000000-0000-0000-0000-000000000000`).
2. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/1/item/<fake_id>`.
3. Проверить, что сервер возвращает статус 404.
4. Убедиться, что ответ содержит поля `result` и `status` с информацией об ошибке.

**Ожидаемый результат:**

- Код ответа: 404.
- Тело ответа содержит `result` и `status`.

---

### 2.3. Передача неверного формата идентификатора

**Пошаговый сценарий:**

1. Отправить GET-запрос с некорректным id, например: `12345`.
2. Проверить, что сервер возвращает код 400 или 404.
3. Убедиться, что в ответе присутствуют поля `result` и `status`.

**Ожидаемый результат:**

- Код ответа: 400 или 404.
- Тело ответа содержит поля `result` и `status`.

---
## 3. Получение объявлений по sellerID (GET /api/1/:sellerID/item)

### 3.1. Получение списка объявлений для продавца с активными публикациями

**Исходные условия:**

- Продавец с sellerID (например, 345678) имеет хотя бы одно объявление.

**Пошаговый сценарий:**

1. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/1/345678/item`.
2. Проверить, что сервер возвращает HTTP-статус 200.
3. Убедиться, что ответ – это массив объектов, каждый из которых имеет поля:
    - `id`
    - `sellerId`
    - `name`
    - `price`
    - `statistics`
    - `createdAt`

**Ожидаемый результат:**

- Код ответа: 200.
- Ответ – массив с описанием объявлений.

---

### 3.2. Запрос объявлений для продавца без публикаций

**Пошаговый сценарий:**

1. Использовать sellerID, для которого гарантировано отсутствуют объявления (например, 999999).
2. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/1/999999/item`.
3. Проверить, что сервер возвращает статус 200.
4. Убедиться, что ответ представляет собой пустой массив.

**Ожидаемый результат:**

- Код ответа: 200.
- Тело ответа – пустой массив `[]`.

---

### 3.3. Некорректный формат sellerID

**Пошаговый сценарий:**

1. Отправить GET-запрос с недопустимым значением sellerID, например: `abc`.
2. Проверить, что сервер возвращает код 400.
3. Убедиться, что в ответе присутствуют поля `result` и `status`.

**Ожидаемый результат:**

- Код ответа: 400.
- Тело ответа содержит `result` и `status`.

---

## 4. Получение статистики объявления (GET /statistic/:id) через V1

### 4.1. Корректное получение статистики (V1)

**Исходные условия:**

- Объявление с определённым id существует и имеет связанные статистические данные.

**Пошаговый сценарий:**

1. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/1/statistic/<id>`.
2. Проверить, что сервер возвращает статус 200.
3. Убедиться, что ответ – массив объектов, где каждый объект включает поля:
    - `likes`
    - `viewCount`
    - `contacts`

**Ожидаемый результат:**

- Код ответа: 200.
- Ответ – массив статистических данных.

---

### 4.2. Запрос статистики для несуществующего объявления (V1)

**Пошаговый сценарий:**

1. Использовать фиктивный id (например, `00000000-0000-0000-0000-000000000001`).
2. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/1/statistic/<fake_id>`.
3. Проверить, что сервер возвращает статус 404.
4. Убедиться, что в ответе присутствуют поля `result` и `status`.

**Ожидаемый результат:**

- Код ответа: 404.
- Тело ответа содержит `result` и `status`.

---

### 4.3. Передача неверного формата id для статистики (V1)

**Пошаговый сценарий:**

1. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/1/statistic/неправильный-id`.
2. Проверить, что сервер возвращает статус 400 или 404.
3. Убедиться, что ответ содержит поля `result` и `status`.

**Ожидаемый результат:**

- Код ответа: 400 или 404.
- Тело ответа включает `result` и `status`.

---

## 5. Получение статистики объявления (GET /statistic/:id) через V2

### 5.1. Правильное получение статистики (V2)

**Исходные условия:**

- Объявление с заданным id существует и статистика доступна.

**Пошаговый сценарий:**

1. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/2/statistic/<id>`.
2. Убедиться, что сервер возвращает статус 200.
3. Проверить, что в ответе получен массив объектов с полями:
    - `likes`
    - `viewCount`
    - `contacts`

**Ожидаемый результат:**

- Код ответа: 200.
- Тело ответа – массив статистических записей.

---

### 5.2. Статистика для несуществующего объявления (V2)

**Пошаговый сценарий:**

1. Использовать фиктивный id (например, `00000000-0000-0000-0000-000000000001`).
2. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/2/statistic/<fake_id>`.
3. Проверить, что сервер возвращает статус 404.
4. Убедиться, что в ответе присутствуют поля `result` и `status`.

**Ожидаемый результат:**

- Код ответа: 404.
- Тело ответа содержит `result` и `status`.

---

### 5.3. Передача некорректного формата id для статистики (V2)

**Пошаговый сценарий:**

1. Отправить GET-запрос на URL:  
   `https://qa-internship.avito.com/api/2/statistic/invalid-format`.
2. Проверить, что сервер возвращает статус 400 или 404.
3. Убедиться, что ответ включает поля `result` и `status`.

**Ожидаемый результат:**

- Код ответа: 400 или 404.
- Тело ответа содержит `result` и `status`.

---

## 6. Удаление объявления (DELETE /api/2/item/:id)

### 6.1. Успешное удаление объявления

**Исходные условия:**

- Объявление создано через POST-запрос, и в ответе получен уникальный id (либо напрямую, либо извлечённый из поля `status`).

**Пошаговый сценарий:**

1. Создать объявление, отправив POST-запрос с телом:
    ```json
    {
      "sellerID": 999999,
      "name": "Объявление для удаления",
      "price": 123,
      "statistics": {
        "likes": 0,
        "viewCount": 0,
        "contacts": 0
      }
    }
    ```
2. Извлечь идентификатор из поля `id` или разобрать поле `status` (например, разделив по " - " и взяв вторую часть).
3. Отправить DELETE-запрос на URL:  
   `https://qa-internship.avito.com/api/2/item/<id>`.
4. Проверить, что сервер возвращает статус 200, а тело ответа отсутствует (пустое).

**Ожидаемый результат:**

- Код ответа: 200.
- Ответ – пустое тело.

---

### 6.2. Попытка удаления несуществующего объявления

**Пошаговый сценарий:**

1. Использовать заведомо несуществующий id, например: `00000000-0000-0000-0000-000000000099`.
2. Отправить DELETE-запрос на URL:  
   `https://qa-internship.avito.com/api/2/item/<fake_id>`.
3. Проверить, что сервер возвращает статус 404.
4. Убедиться, что в ответе присутствуют поля `result` и `status`.

**Ожидаемый результат:**

- Код ответа: 404.
- Тело ответа содержит `result` и `status`.

---

### 6.3. Удаление с некорректным форматом id

**Пошаговый сценарий:**

1. Отправить DELETE-запрос с неверным значением id, например: `abc`.
2. Проверить, что сервер возвращает статус 400.
3. Убедиться, что ответ включает поля `result` и `status` с описанием ошибки.

**Ожидаемый результат:**

- Код ответа: 400.
- Тело ответа содержит `result` и `status`.

---

 
